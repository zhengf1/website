<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
  <link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />

	<title>Zheng Fan's personal website</title>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />

	<meta name="keywords" content="" />
	<meta name="description" content="" />

	<link rel="stylesheet" type="text/css" href="second.css" media="all" /> 
	<link rel="stylesheet" type="text/css" href="resume.css" media="all" />
    <style>
        /* Sidebar style */
        #sidebar {
            width: 300px;
            position: fixed;
            top: 20px; /* Adjust to your header height */
            left: 0;
            background-color: #f4f4f4;
            padding-top: 20px;
            padding-left: 20px;
            border-right: 3px solid #ccc;
            height: 100%;
        }

        /* Sidebar links */
        #sidebar a {
            display: block;
            padding: 8px 0;
            color: #111D3D;
            text-decoration: none;
            font-size: 16px;
        }

        #sidebar a:hover {
            background-color: #ddd;
            color: #000;
        }

        /* Main content area */
        #main-content {
            margin-left: 220px; /* Space for the sidebar */
            padding: 20px;
        }


        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }

        /* Add some padding to sections to make it easier to spot when scrolling */
        section {
            padding: 220px 0;
            margin: 220px 0;
        }

                #Welcome!, #Research Interests, #Research and Working Papers, #Conference and Seminar Presentations, #Academic and Teaching Experience, #Skills {
            scroll-margin-top: 220px; /* Adjust this value to match your navbar height */
            padding-top: 230px; /* Give some space to the sections */
        }

/* --- SHARED GAME STYLES --- */
        .game-container-style {
            position: relative;
            width: 100%;
            max-width: 600px; 
            height: 400px;
            margin: 20px 0;
            background-color: #70c5ce;
            overflow: hidden;
            border: 4px solid #2c3e50;
            border-radius: 8px;
            font-family: 'Press Start 2P', cursive;
            outline: none;
        }

        .game-canvas-style {
            display: block;
            width: 100%;
            height: 100%;
        }

        .game-ui-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .game-message-box {
            background: #ded895;
            border: 4px solid #543847;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 6px 6px 0px rgba(0,0,0,0.2);
            pointer-events: auto;
            display: none;
            width: 80%;
            max-width: 400px;
        }

        .game-title {
            color: #fff;
            text-shadow: 3px 3px 0 #000;
            font-size: 28px;
            margin: 10px 0;
            line-height: 1.2;
        }

        .game-text {
            color: #543847;
            font-size: 12px;
            line-height: 1.5;
            margin-bottom: 10px;
        }

        .game-input {
            font-family: 'Press Start 2P', cursive;
            background: #fff;
            border: 2px solid #543847;
            padding: 8px;
            margin-bottom: 10px;
            width: 180px;
            text-align: center;
            text-transform: uppercase;
            font-size: 12px;
        }

        .button-row {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }

        .game-btn {
            background: #e96030;
            color: white;
            border: none;
            padding: 10px 15px;
            font-family: inherit;
            font-size: 12px;
            cursor: pointer;
            border-radius: 4px;
            border-bottom: 4px solid #9e3b1a;
            text-transform: uppercase;
            flex: 1;
            min-width: 100px;
        }

        .game-btn:active {
            transform: translateY(4px);
            border-bottom: 0px;
        }
        
        .game-btn.secondary {
            background: #70c5ce;
            border-bottom: 4px solid #4a8b94;
        }

        .game-btn:disabled {
            background: #ccc;
            border-bottom: 4px solid #999;
            cursor: not-allowed;
        }

        .score-display-style {
            position: absolute;
            top: 20px;
            width: 100%;
            text-align: center;
            font-size: 40px;
            color: white;
            text-shadow: 3px 3px 0 #000;
            pointer-events: none;
            z-index: 10;
        }

        /* Specific Tetris Styles */
        #tetris-game-container {
            background-color: #202028; /* Dark Arcade Background */
        }
        
        #tetris-game-over-screen .game-message-box, #tetris-start-screen .game-message-box {
            background-color: #2c3e50;
            border-color: #fff;
        }
        
        #tetris-game-over-screen h1, #tetris-start-screen h1 {
            color: #e74c3c;
            text-shadow: 2px 2px 0 #000;
        }
        
        #tetris-start-screen p, #tetris-game-over-screen p {
            color: #ecf0f1;
        }
        
        #tetris-score-display {
             color: #fff;
             text-shadow: 2px 2px 0 #000;
             opacity: 0.8;
        }

    </style>
 <!-- Font Awesome (for GitHub, Email, LinkedIn, ORCID icons) -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<!-- Academicons (for Google Scholar) -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.4/css/academicons.min.css">

</head>
<body>

<div id="doc2" class="yui-t7">
	<div id="inner">
	
	<div id="hd">
  <div class="header-container">

    <!-- Left: Name and Title -->
<div class="header-left">
  <h1><span style="font-weight: bold; color: #d63384;">Zheng</span> Fan</h1>
  <h3>PhD Candidate in Economics</h3>
</div>
 <!-- Right: Contact Info -->
    <div class="header-right">
      <div class="contact-info">
<!-- Icon block aligned to the right -->
<div style="display: flex; justify-content: flex-end; gap: 12px; align-items: center; margin-top: 18px;">
  <a href="mailto:zhengfan2015@gmail.com" target="_blank" style="display: inline-flex; align-items: center; color: #333;">
    <i class="fas fa-envelope" style="font-size: 20px;" title="Email"></i>
  </a>

  <a href="https://github.com/zhengf1" target="_blank" style="display: inline-flex; align-items: center; color: #333;">
    <i class="fab fa-github" style="font-size: 20px;" title="GitHub"></i>
  </a>
  <a href="https://scholar.google.com/citations?user=kObE768AAAAJ" target="_blank" style="display: inline-flex; align-items: center; color: #4285F4;">
    <i class="fas fa-graduation-cap" style="font-size: 20px;" title="Google Scholar"></i>
  </a>
  
  <a href="https://www.linkedin.com/in/zheng-fan-11849836b" target="_blank" style="display: inline-flex; align-items: center; color: #0077b5;">
    <i class="fab fa-linkedin" style="font-size: 20px;" title="LinkedIn"></i>
  </a>

  <a href="https://orcid.org/0000-0002-5203-4857" target="_blank" style="display: inline-flex; align-items: center; color: #a6ce39;">
    <i class="fab fa-orcid" style="font-size: 20px;" title="ORCID"></i>
  </a>
</div>
        <p>
          <a id="pdf" href="cv-page.html">Download CV</a>
        </p>
      </div>
    </div>

  </div> <!--// .header-container -->
</div> <!--// #hd -->

		<div id="bd">
			<div id="yui-main">
				<div class="yui-b">

 
<div id="navbar">
<a href="index.html">Home</a>
<a href="research.html">Research</a>
<a href="teaching.html" class="active">Teaching</a>
<a href="skills.html">Others</a>
         <!-- Add more links as needed -->
</div>
 

<div style="margin-bottom: 30px;" id="academic-teaching">
  <h3 style="color: #2c3e50;">Teaching and Academic Services</h3>
  <hr style="border: none; height: 1px; background-color: #ddd; margin: 6px 0;">

  <p style="color: #333; font-weight: bold; margin: 0 0 4px 0;">
    Department of Economics, The University of Melbourne
  </p>
  <p style="margin: 0 0 8px 0;">
    <strong style="color: #d63384;">• Teaching Assistant (Tutor)</strong> (2019 – present)
  </p>

  <ul style="list-style-type: none; padding-left: 0; margin: 0 0 0 10px; line-height: 0.8;">
    <li>– <strong>ECON10003: Introductory Macroeconomics:</strong> 2019-S2; 2020-S1; 2021-S1; 2022-S1</li>
    <li>– <strong>ECON10005: Quantitative Methods 1:</strong> 2021-S1; 2022-S1;
      <a href="https://github.com/zhengf1/2023QM1" target="_blank">2023-S1</a>;
      <a href="https://github.com/zhengf1/2025S1QM1" target="_blank">2025-S1</a>
    </li>
    <li>– <strong>ECON20001: Intermediate Macroeconomics:</strong> 2021-S2;
      <a href="https://github.com/zhengf1/InterMa2022" target="_blank">2022-S2</a>
    </li>
    <li>– <strong>ECON20003: Quantitative Methods 2:</strong>
      <a href="https://github.com/zhengf1/2023QM2" target="_blank">2023-Summer</a>
    </li>
    <li>– <strong>ECOM20001: Econometrics 1:</strong> 2022-S1;
      <a href="https://github.com/zhengf1/2023ECOM1" target="_blank">2023-S1</a>;
      <a href="https://github.com/zhengf1/2024ECOM1" target="_blank">2024-S2</a>;
      <a href="https://github.com/zhengf1/2025ECOM1" target="_blank">2025-S1</a>;
      <a href="https://github.com/zhengf1/2025S2ECOM1" target="_blank">2025-S2</a>
    </li>
    <li>– <strong>ECOM90025: Advanced Data Analysis:</strong>
      <a href="https://github.com/zhengf1/ADA2022" target="_blank">2022-S2</a>;
      <a href="https://github.com/zhengf1/2023-S2-ADA" target="_blank">2023-S2</a>
    </li>

  </ul>

  <li style="margin: 0 0 -10px 0;">
    You may find some of my teaching materials on GitHub for these subjects 
    (click the year-semester for navigation)
  </li>
</div>

  <p style="color: #333; font-weight: bold; color: #333;; margin: 0 0 4px 0;">
    Melbourne Business School, The University of Melbourne
  </p>
  <p style="margin: 0 0 12px 0;">
    <strong style="color: #d63384;">• Online Tutor (TA)</strong> (May - June 2025)
  </p>

  <p style="color: #333; font-weight: bold; color: #333;; margin: 0 0 4px 0;">
    Department of Economics, The University of Melbourne
  </p>
  <p style="margin: 0 0 12px 0;">
    <strong style="color: #d63384;">• Research Assistant (RA)</strong> (2021 – present)
  </p>

  <p style="color: #333; font-weight: bold; color: #333;; margin: 0 0 4px 0;">
    Melbourne Institute of Applied Economic and Social Research, The University of Melbourne
  </p>
  <p style="margin: 0 0 12px 0;">
    <strong style="color: #d63384;">• Research Assistant (RA)</strong> (2019)
  </p>
 
 <p style="color: #333; font-weight: bold; color: #333;; margin: 0 0 4px 0;">
   Ormond College, The University of Melbourne
  </p>
 
  <p style="margin: 0 0 12px 0;">
    <strong style="color: #d63384;">• Academic Tutor</strong> for <em>ECOM30002: Econometrics 2</em> (2019)
  </p>
 
</div>
 
 <!-- GAME SECTION -->
<div style="margin-bottom: 30px;" id="Game">
    <h3 style="color: #2c3e50;">Take a Break</h3>
    <hr style="border: none; height: 1px; background-color: #ddd; margin: 8px 0;">
    <p>Need a distraction? Click inside the box below to play a quick game!</p>

    <!-- TETRIS GAME -->

    <div id="tetris-game-container" class="game-container-style" tabindex="0">
        <div id="tetris-score-display" class="score-display-style">0</div>

        <div id="tetris-ui-layer" class="game-ui-layer">
            <!-- Start Screen -->
            <div id="tetris-start-screen" class="game-message-box" style="display: block;">
                <h1 class="game-title">TETRIS</h1>
                <p class="game-text">Arrows to Move<br>Up / Tap to Rotate</p>
                <button class="game-btn" id="btn-tetris-start" style="background:#e74c3c; border-color:#c0392b;">START</button>
            </div>
            
            <!-- Game Over Screen -->
             <div id="tetris-game-over-screen" class="game-message-box">
                <h1 class="game-title">GAME OVER</h1>
                <p class="game-text">Score: <span id="tetris-final-score">0</span></p>
                <button class="game-btn" id="btn-tetris-retry" style="background:#e74c3c; border-color:#c0392b;">Try Again</button>
            </div>
        </div>
        <canvas id="tetris-canvas" class="game-canvas-style"></canvas>
    </div>

</div>

				</div><!--// .yui-b -->
			</div><!--// yui-main -->
		</div><!--// bd -->

        <div id="ft">
            <p>Zheng Fan &mdash;           <a href="mailto:zhengfan2015@gmail.com">zhengfan2015 <span class="circle">at</span> gmail.com</a></p> 
                <p>Website update in June 2025</a></p>
        </div><!--// footer -->

	</div><!-- // inner -->

<footer id="footer-bar">
  <p>&copy; Copyright 2025 Zheng Fan. All rights reserved.</p>
</footer>
</div><!--// doc -->

<!-- GAME SCRIPT MODULE -->
<script type="module">

 
    

    /* =========================================
       GAME: TETRIS
       ========================================= */
       
    const tContainer = document.getElementById('tetris-game-container');
    const tCanvas = document.getElementById('tetris-canvas');
    const tCtx = tCanvas.getContext('2d');
    const tScoreEl = document.getElementById('tetris-score-display');
    const tStartScreen = document.getElementById('tetris-start-screen');
    const tGameOverScreen = document.getElementById('tetris-game-over-screen');
    const tFinalScoreEl = document.getElementById('tetris-final-score');
    
    document.getElementById('btn-tetris-start').addEventListener('click', tStartGame);
    document.getElementById('btn-tetris-retry').addEventListener('click', tResetGame);

    const ROW = 20;
    const COL = 10;
    const VACANT = "#202028"; // Board color
    let SQ = 20; // Square size, calculated dynamically

    let board = [];
    let tScore = 0;
    let tGameState = 'START';
    let tDropStart = Date.now();
    let tGameOverState = false;
    let tRequestID;

    // The Tetrominoes
    const PIECES = [
        [Z, "red"],
        [S, "green"],
        [T, "purple"],
        [O, "yellow"],
        [L, "orange"],
        [I, "cyan"],
        [J, "blue"]
    ];

    // Shapes
    function I() { return [[ [0, 1, 0, 0], [0, 1, 0, 0], [0, 1, 0, 0], [0, 1, 0, 0] ], [ [0, 0, 0, 0], [1, 1, 1, 1], [0, 0, 0, 0], [0, 0, 0, 0] ], [ [0, 0, 1, 0], [0, 0, 1, 0], [0, 0, 1, 0], [0, 0, 1, 0] ], [ [0, 0, 0, 0], [0, 0, 0, 0], [1, 1, 1, 1], [0, 0, 0, 0] ]]; }
    function J() { return [[ [1, 0, 0], [1, 1, 1], [0, 0, 0] ], [ [0, 1, 1], [0, 1, 0], [0, 1, 0] ], [ [0, 0, 0], [1, 1, 1], [0, 0, 1] ], [ [0, 1, 0], [0, 1, 0], [1, 1, 0] ]]; }
    function L() { return [[ [0, 0, 1], [1, 1, 1], [0, 0, 0] ], [ [0, 1, 0], [0, 1, 0], [0, 1, 1] ], [ [0, 0, 0], [1, 1, 1], [1, 0, 0] ], [ [1, 1, 0], [0, 1, 0], [0, 1, 0] ]]; }
    function O() { return [[ [0, 0, 0, 0], [0, 1, 1, 0], [0, 1, 1, 0], [0, 0, 0, 0] ]]; }
    function S() { return [[ [0, 1, 1], [1, 1, 0], [0, 0, 0] ], [ [0, 1, 0], [0, 1, 1], [0, 0, 1] ], [ [0, 0, 0], [0, 1, 1], [1, 1, 0] ], [ [1, 0, 0], [1, 1, 0], [0, 1, 0] ]]; }
    function T() { return [[ [0, 1, 0], [1, 1, 1], [0, 0, 0] ], [ [0, 1, 0], [0, 1, 1], [0, 1, 0] ], [ [0, 0, 0], [1, 1, 1], [0, 1, 0] ], [ [0, 1, 0], [1, 1, 0], [0, 1, 0] ]]; }
    function Z() { return [[ [1, 1, 0], [0, 1, 1], [0, 0, 0] ], [ [0, 0, 1], [0, 1, 1], [0, 1, 0] ], [ [0, 0, 0], [1, 1, 0], [0, 1, 1] ], [ [0, 1, 0], [1, 1, 0], [1, 0, 0] ]]; }

    // Need to define these variables for the functions above to work as reference, but actually I will just use the functions directly in Piece class.
    // Wait, simplified logic:
    const Tetrominoes = [
        [ [1, 1, 0], [0, 1, 1] ], // Z (Simplified definition for logic below)
    ];
    
    // Better Piece Definition
    const PieceShapes = [
        [Z, "red"], [S, "green"], [T, "purple"], [O, "yellow"], [L, "orange"], [I, "cyan"], [J, "blue"]
    ];

    // Helper to get shape arrays
    function getShape(type) {
        switch(type) {
            case 'I': return I();
            case 'J': return J();
            case 'L': return L();
            case 'O': return O();
            case 'S': return S();
            case 'T': return T();
            case 'Z': return Z();
        }
    }

    // Variables
    let p; 

    // Resize & Setup
    function tResize() {
        if (!tContainer) return;
        tCanvas.width = tContainer.clientWidth;
        tCanvas.height = tContainer.clientHeight;
        
        // Calculate SQ size to fit 20 rows in height
        SQ = Math.floor(tCanvas.height / ROW);
        
        // Center the board horizontally
        tCtx.translate((tCanvas.width - (COL * SQ)) / 2, 0);

        if (tGameState === 'START') drawBoard();
    }
    window.addEventListener('resize', tResize);
    setTimeout(tResize, 100);

    // Draw Square
    function drawSquare(x, y, color) {
        tCtx.fillStyle = color;
        tCtx.fillRect(x * SQ, y * SQ, SQ, SQ);
        tCtx.strokeStyle = "#2c3e50"; // Border color
        tCtx.strokeRect(x * SQ, y * SQ, SQ, SQ);
    }

    // Create Board
    function createBoard() {
        for(let r = 0; r < ROW; r++) {
            board[r] = [];
            for(let c = 0; c < COL; c++) {
                board[r][c] = VACANT;
            }
        }
    }

    // Draw Board
    function drawBoard() {
        // Add safety check to prevent crash if board isn't ready
        if (!board || board.length === 0) return;

        // Clear entire canvas first (taking translate into account)
        tCtx.save();
        tCtx.setTransform(1, 0, 0, 1, 0, 0);
        tCtx.fillStyle = "#202028";
        tCtx.fillRect(0, 0, tCanvas.width, tCanvas.height);
        tCtx.restore();

        for(let r = 0; r < ROW; r++) {
            for(let c = 0; c < COL; c++) {
                if (board[r] && board[r][c] !== undefined) {
                    drawSquare(c, r, board[r][c]);
                }
            }
        }
    }

    // Piece Object
    function Piece(tetromino, color) {
        this.tetromino = tetromino;
        this.color = color;
        this.tetrominoN = 0; // Rotation index
        this.activeTetromino = this.tetromino[this.tetrominoN];
        
        // Center piece
        this.x = 3;
        this.y = -2;
    }

    Piece.prototype.fill = function(color) {
        for(let r = 0; r < this.activeTetromino.length; r++) {
            for(let c = 0; c < this.activeTetromino.length; c++) {
                if(this.activeTetromino[r][c]) {
                    drawSquare(this.x + c, this.y + r, color);
                }
            }
        }
    }

    Piece.prototype.draw = function() {
        this.fill(this.color);
    }

    Piece.prototype.unDraw = function() {
        this.fill(VACANT);
    }

    Piece.prototype.moveDown = function() {
        if(!this.collision(0, 1, this.activeTetromino)) {
            this.unDraw();
            this.y++;
            this.draw();
        } else {
            this.lock();
            if (tGameState === 'PLAYING') p = randomPiece();
        }
    }

    Piece.prototype.moveRight = function() {
        if(!this.collision(1, 0, this.activeTetromino)) {
            this.unDraw();
            this.x++;
            this.draw();
        }
    }

    Piece.prototype.moveLeft = function() {
        if(!this.collision(-1, 0, this.activeTetromino)) {
            this.unDraw();
            this.x--;
            this.draw();
        }
    }

    Piece.prototype.rotate = function() {
        let nextPattern = this.tetromino[(this.tetrominoN + 1) % this.tetromino.length];
        let kick = 0;
        
        if(this.collision(0, 0, nextPattern)) {
            if(this.x > COL/2) kick = -1; // Wall kick left
            else kick = 1; // Wall kick right
        }
        
        if(!this.collision(kick, 0, nextPattern)) {
            this.unDraw();
            this.x += kick;
            this.tetrominoN = (this.tetrominoN + 1) % this.tetromino.length;
            this.activeTetromino = this.tetromino[this.tetrominoN];
            this.draw();
        }
    }

    Piece.prototype.lock = function() {
        for(let r = 0; r < this.activeTetromino.length; r++) {
            for(let c = 0; c < this.activeTetromino.length; c++) {
                if(!this.activeTetromino[r][c]) continue;
                
                if(this.y + r < 0) {
                    // Game Over
                    tGameOverState = true;
                    tGameOver();
                    return;
                }
                
                board[this.y + r][this.x + c] = this.color;
            }
        }
        
        // Remove full rows
        for(let r = 0; r < ROW; r++) {
            let isRowFull = true;
            for(let c = 0; c < COL; c++) {
                isRowFull = isRowFull && (board[r][c] != VACANT);
            }
            if(isRowFull) {
                // Move down all rows above
                for(let y = r; y > 1; y--) {
                    for(let c = 0; c < COL; c++) {
                        board[y][c] = board[y-1][c];
                    }
                }
                for(let c = 0; c < COL; c++) board[0][c] = VACANT;
                tScore += 10;
                tScoreEl.innerText = tScore;
            }
        }
        drawBoard();
    }

    Piece.prototype.collision = function(x, y, piece) {
        for(let r = 0; r < piece.length; r++) {
            for(let c = 0; c < piece.length; c++) {
                if(!piece[r][c]) continue;
                
                let newX = this.x + c + x;
                let newY = this.y + r + y;
                
                if(newX < 0 || newX >= COL || newY >= ROW) return true;
                if(newY < 0) continue;
                if(board[newY][newX] != VACANT) return true;
            }
        }
        return false;
    }

    function randomPiece() {
        let r = Math.floor(Math.random() * PIECES.length);
        // Re-map to functions to get fresh arrays
        let type = "";
        if (r==0) type="Z"; else if (r==1) type="S"; else if (r==2) type="T"; else if (r==3) type="O";
        else if (r==4) type="L"; else if (r==5) type="I"; else if (r==6) type="J";
        
        return new Piece(getShape(type), PIECES[r][1]);
    }

    // Game Loop
    function tUpdate() {
        if (tGameState !== 'PLAYING') return;
        
        let now = Date.now();
        let delta = now - tDropStart;
        if(delta > 1000) { // 1 sec drop speed
            p.moveDown();
            tDropStart = Date.now();
        }
        tRequestID = requestAnimationFrame(tUpdate);
    }

    function tStartGame() {
        tGameState = 'PLAYING';
        tGameOverState = false;
        tStartScreen.style.display = 'none';
        tGameOverScreen.style.display = 'none';
        tScoreEl.style.display = 'block';
        tScore = 0;
        tScoreEl.innerText = tScore;
        createBoard();
        drawBoard();
        p = randomPiece();
        p.draw();
        tDropStart = Date.now();
        tContainer.focus();
        tUpdate();
    }

    function tResetGame() {
        tStartGame();
    }

    function tGameOver() {
        tGameState = 'GAMEOVER';
        cancelAnimationFrame(tRequestID);
        tFinalScoreEl.innerText = tScore;
        tGameOverScreen.style.display = 'block';
        tScoreEl.style.display = 'none';
    }

    // Controls
    tContainer.addEventListener('keydown', function(e) {
        if(tGameState !== 'PLAYING') return;
        if(e.code === "ArrowLeft") { p.moveLeft(); tDropStart = Date.now(); e.preventDefault(); }
        else if(e.code === "ArrowUp") { p.rotate(); tDropStart = Date.now(); e.preventDefault(); }
        else if(e.code === "ArrowRight") { p.moveRight(); tDropStart = Date.now(); e.preventDefault(); }
        else if(e.code === "ArrowDown") { p.moveDown(); e.preventDefault(); }
    });

    // Mobile Controls
    let tTouchX = 0;
    let tTouchY = 0;
    tContainer.addEventListener('touchstart', function(e) {
        tTouchX = e.touches[0].clientX;
        tTouchY = e.touches[0].clientY;
        tContainer.focus();
        if(tGameState === 'PLAYING') e.preventDefault();
    }, {passive: false});

    tContainer.addEventListener('touchend', function(e) {
        if(tGameState !== 'PLAYING') return;
        let endX = e.changedTouches[0].clientX;
        let endY = e.changedTouches[0].clientY;
        let dx = endX - tTouchX;
        let dy = endY - tTouchY;

        if (Math.abs(dx) < 10 && Math.abs(dy) < 10) {
            p.rotate(); // Tap to rotate
        } else if (Math.abs(dx) > Math.abs(dy)) {
            if(dx > 0) p.moveRight(); else p.moveLeft();
        } else {
            if(dy > 0) p.moveDown();
        }
    });

    // Initial Setup
    createBoard();
    tResize();

</script>

</body>
</html>